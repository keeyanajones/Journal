<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Code Journal: Documentation &amp; Version Control</title>   
    <!-- Latest compiled and minified CSS -->     
    <!-- Font Awesome 5.0.13 -->     
    <link rel="stylesheet" 
          href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" 
          integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" 
          crossorigin="anonymous">         
    <!-- Bootstrap 3.3.7 --> 
    <link rel="stylesheet" 
          href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" 
          crossorigin="anonymous">
    <!-- Highlight.js 9.13.1 -->     
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/androidstudio.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>    
    <script>hljs.initHighlightingOnLoad();</script>      
    
    <!-- Custom Style Pygment and Icons -->     
    <link rel="stylesheet" href="../assets/stylesheets/styles.css">
    <link rel="stylesheet" href="../assets/stylesheets/pygment_trac.css">
    <link rel="icon" href="../assets/images/favicon.ico" type="image/gif">
    <link rel="shortcut icon" href="../assets/images/favicon.png">    
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  
  <body>
    <div class="wrapper">               
    <!-- Header -->         
      <header>
          <img src="../assets/images/pb_Image.png" class="img-fluid" alt="me"/>
        <p class="view">A Code Journal for 
            <span class="fab fa-git-square" aria-hidden="true"></span>
                Hub Pages<br/>        
                
            <a href="https://github.com/keeyanajones/Journal" target="_blank">
            <span class="fab fa-github"></span> 
              View the Code Journal on GitHub</a></p>
                      
                        
            <button class="btn btn-md btn-default" type="button">
                <span class="fab fa-java fa-2x"></span> 
            </button>                
            
            <button class="btn btn-md btn-default" type="button">
                <span class="fab fa-python fa-2x"></span> 
            </button>                        

            <button class="btn btn-md btn-default" type="button">
                <span class="fab fa-r-project  fa-2x"></span> 
            </button>                
            
            <button class="btn btn-md btn-default" type="button">
            <span class="fab fa-js fa-2x"></span> 
            </button>                              

            <br/><br/>
            
            <a href="https://github.com/keeyanajones/">
            <small><span class="fab fa-github-alt"></span>                 
            Repositories and latest Contribution Activity</small></a>                 
              
        <br/>
        
        <!-- Download, Clone, or Fork -->
        <ul>    
          <li><a href="https://github.com/keeyanajones/Journal/archive/master.zip">
              <span class="fa fa-file-archive" aria-hidden="true"></span><br/>
                  Download <br/> ZIP</a></li>                  
          <li><a href="https://github.com/keeyanajones/Journal">
              <span class="fa fa-clone" aria-hidden="true"></span><br/>
                  Clone <br/> Desktop</a></li>                  
          <li><a href="https://github.com/keeyanajones/Journal">
              <span class="fa fa-code-branch" aria-hidden="true"></span><br/>
                  Fork On <br/> GitHub</a></li>
        </ul>                                 
      </header>
    <!-- ./header --> 
    </div>          
      
    <section>
        <h2><span class="fa fa-file-alt" aria-hidden="true"></span>
              <a name="documentation-version" class="anchor" 
                 href="#documentation-version">
              <span class="header-link"></span></a>
          Documentation &amp; Version Control
        </h2>                  
     
        <p><sup><span class="fa fa-calendar"></span>
                Last updated on May 6th, 2019</sup></p>
                                                
        <ol class="breadcrumb">
            <li><span class="fa fa-bookmark"></span>
                <a href="../index.html">Home</a></li>
            
          <li class="active"><a href="index.html">
                <span class="fa fa-bookmark"></span> 
                Documentation &amp; Version</a></li>
                
          <li class="active"><a href="#logging">
                <span class="fa fa-bookmark"></span> 
               Logging</a></li>                
        </ol>
                                 
        <a name="logging" id="logging"></a>                    
        <p>Logging is an important part of supporting the complete application 
           life cycle. From creation to debugging to planning new features, 
           logs support us all the way. By analyzing the data in the logs, we
           can glean insights, resolve bugs much quicker, and detect problems 
           early as they happen.</p>
               
        <h4>TYPES OF LOGS</h4>
        
        <ul>
            <li>PERFORMANCE—measure and track performance with automatic 
                             logging.</li>
            <li>DEBUGGING—first step in debugging is log analysis to see where 
                           the error occurred and conditions.</li>
            <li>ERROR TRACKING—when errors started, how often they occurred, 
                                for whom they occurred, if they’ve been 
                                resolved, and if they’ve resurfaced to keep 
                                track of errors.</li>
            <li>ANALYZING LOGS—rich sources of information to analyze logs to 
                                discover usage patterns to guide decisions.
            <li>CUSTOM LOGS-chat logs for example.</li> 
        </ul>
        
        <h4>WHAT TO LOG</h4>        
        <p>What to log really depends on your situation. But to give a good 
           starting points, log data usually includes:</p>        
        <ul>
           <li>Timestamp or log entry</li>
           <li>Timing data for request</li>
           <li>Request endpoint data (i.e. paths “/users” and verbs "GET or POST")</li>
           <li>IP of the requesting party</li>
           <li>Correlation ID (i.e. for a distributed system)</li>
        </ul>
        
        <h4>HOW TO LOG</h4>        
        <p>JSON is the default standard for logging in Node.js. Thus, logging 
           tools support JSON out of the box, and parse JSON logs for anaysis. 
           This allows visualizing based on nested properties. Any format you 
           want—strings, delimited, or a custom format should be avoided where 
           possible. However, you must specify the rules for every different 
           format, and can be time-consuming.</p>
        
        <p>Keeping namespaces dictionary, which allows you to define which 
           namespace patterns you want and reject any calls to logs that don’t 
           conform to your namespace dictionary patterns to enforce clean 
           logging standards throughout the application implementation:</p>

<pre><code>
logger.info('server.endpoint.get.users.getuserfromapi.format');
</code></pre>
        
        <p>The log originated in the server, in a GET endpoint called 
           “/users” while it was formatting a response retrieved from 
           the api. Namespaces make it easy to recognize and locate logging 
           within the application.</p>
        
        <h4>DESIGN PATTERN</h4>        
        <p>Ideally, logging is to be done in the facade design pattern
           this type of design pattern comes under structural classification.   
           It adds an interface to existing systems to hide complex 
           implementation details to leverage elegant logging code to the 
           system and provides an interface to clients which allow access. 
           This pattern involves a single class which provides simplified 
           methods required by client and delegates calls to methods of 
           existing system classes. This pattern is often used when creating
           a simplified interface that performs many other actions behind the 
           scenes.</p> 
                
        <p>See <span class="fa fa-file-code"></span>
        <a href="../design-patterns/index.html#facade"> 
            Facade Design Pattern</a> to learn more...</p>
             
        <p>The thinking here is using functional programming in Node.js by 
           passing the handler function as a callback to the handler function, 
           allowing execution of the function within the context of a try/catch
           to apply error handling in a way that makes sense to centralize logs 
           for visualization, searching, and troubleshooting.</p>        
                        
        <p>Finally, we access logging middleware:</p> 
            
         Winston Logging - <span class="fab fa-github fa-2x"></span>
        <a href="https://github.com/winstonjs/winston" target="_blank">
            <small>https://github.com/winstonjs</small>
        </a>
         Morgan Logging - <span class="fab fa-github fa-2x"></span>
        <a href="https://github.com/expressjs/morgan" target="_blank">
            <small>https://github.com/expressjs/morgan</small>
        </a><br/>
                      
        <!-----------------------
        //// Logging :  Tab Navigation
        ------------------------>
        <div>
        <!-- Nav tabs -->
        <ul class="nav nav-tabs" role="tablist">            
            <li role="presentation" class="active">            
            <a href="#winston" 
            aria-controls="winston" 
            role="tab" data-toggle="tab">
            Winston</a></li>            
            <li role="presentation">
            <a href="#morgan" 
            aria-controls="morgan" 
            role="tab" data-toggle="tab">
            Morgan</a></li>           
        </ul>
        <!------------------------------------------------// 
          Tab panes 
        // ----------------------------------------------->
        <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="winston">        
        <p>Winston is designed to be a simple and universal logging library 
           with support for multiple transports. A transport is essentially 
           a storage device for your logs. Each winston logger can have 
           multiple transports (see: Transports) configured at different 
           levels (see: Logging levels). For example, one may want error 
           logs to be stored in a persistent remote location (like a database), 
           but all logs output to the console or a local file.</p>

        <p>Winston aims to decouple parts of the logging process to make it 
           more flexible and extensible. Attention is given to supporting 
           flexibility in log formatting (see: Formats) & levels 
           (see: Using custom logging levels), and ensuring those APIs 
           decoupled from the implementation of transport logging 
           (i.e. how the logs are stored / indexed, see: Adding Custom 
           Transports) to the API that they exposed to the programmer.
        </p>
        
<pre><code>
const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  defaultMeta: { service: 'user-service' },
  transports: [
 //
 // - Write to all logs with level `info` and 
 //   below to `combined.log` 
 // - Write all logs error (and below) to `error.log`.
 //
    new winston.transports.File(
                { filename: 'error.log', level: 'error' }),
    new winston.transports.File(
                { filename: 'combined.log' })
  ]
});

//
// If we're not in production then log to the `console` 
// with the format:
//`${info.level}: ${info.message} JSON.stringify({ ...rest })`
// 
if (process.env.NODE_ENV !== 'production') {
  logger.add(new winston.transports.Console({
    format: winston.format.simple()
  }));
}
</code></pre>
        </div>

        <div role="tabpanel" class="tab-pane" id="morgan">       
        <p>HTTP request logger middleware for node.js.</p>
        
<pre><code>
var express = require('express')
var fs = require('fs')
var morgan = require('morgan')
var path = require('path')

var app = express()

// create a write stream (in append mode)
var accessLogStream = 
    fs.createWriteStream(path.join(__dirname, 'access.log'), 
                                  { flags: 'a' })

// setup the logger
app.use(morgan('combined', { stream: accessLogStream }))

app.get('/', function (req, res) {
  res.send('hello, world!')
})
</code></pre>                   
        </div>        
        </div>
        </div>
    
<hr/>        

        <h3><a name="take-five" class="anchor" href="#take-five">
          <span class="header-link"></span></a>
          Review</h3>
          
        <p>Alright, let's recap what I've just learned:</p>
            
        <ul>
           <li>Logging is an important part of the complete application life cycle. 
               The point is to centralize logs for visualization, searching, and 
               troubleshooting.</li>
        
           <li>Typically, there are 5 types of logs:</li>
           
                <ul>                            
                    <li>performance, debugging, error tracking, analysis, and custom</li>
                </ul>
           
           <li>Logging depends on your situation. But a good starting point includes:</li>
           
           <ul>
              <li>Timestamp or log entry</li>
              <li>Timing data for request</li>
              <li>Request endpoint data (i.e. paths “/users” and verbs "GET or POST")</li>
              <li>IP of the requesting party</li>
              <li>Correlation ID (i.e. for a distributed system)</li>
            </ul>  
            
           <li>Other things to note:</li>
           
            <ul>
              <li>JSON is the default standard for logging in Node.js.</li>         
              <li>Namespace dictionary patterns to enforce clean logging standards</li>
              <li>The Facade design pattern is used to hide complexity</li>
            </ul>  
                        
        </ul>
        
    <p>You can read more at: 
        <a href="https://stackify.com/winston-logging-tutorial/"
           target="_blank">
           <small>https://stackify.com/winston-logging-tutorial/</small>
        </a>
        and 
        <a href="https://jojozhuang.github.io/tutorial/nodejs/express-combine-morgan-and-winston/"
           target="_blank">
        <small>https://jojozhuang.github.io/tutorial/nodejs/express-combine-morgan-and-winston/</small>    
    </p>

      <!-- pagination -->
       <a role="button" class="btn btn-primary pull-left"  
               href="../testing/index.html">
            &larr; PREVIOUS: Testing</a>
          
      <a role="button" class="btn btn-primary pull-right" 
              href="../appendix/index.html">
            NEXT: Appendix &rarr;</a><br/><br/>
    </section>
        
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" 
            crossorigin="anonymous"></script>         
    <script src="../assets/javascripts/scale.fix.js"></script>
  </body>
</html>

        
        